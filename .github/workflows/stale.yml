name: Mark stale issues and pull requests

on:
  schedule:
    # Run every day at 00:30 UTC
    - cron: '30 0 * * *'
  workflow_dispatch:

permissions:
  issues: write
  pull-requests: write

jobs:
  stale:
    runs-on: ubuntu-latest
    steps:
      - name: Mark stale issues and PRs
        uses: actions/stale@v8
        with:
          repo-token: ${{ secrets.GITHUB_TOKEN }}
          
          # Issue configuration
          stale-issue-message: |
            This issue has been automatically marked as stale because it has not had recent activity. 
            It will be closed if no further activity occurs. 
            
            If this issue is still relevant, please:
            - Comment to keep it open
            - Add the `keep-open` label
            - Provide additional context or updates
            
            Thank you for your contributions! üöÄ
          
          close-issue-message: |
            This issue was automatically closed because it has been stale for too long without activity.
            
            If you believe this issue should remain open, please reopen it and provide:
            - Updated reproduction steps (if it's a bug)
            - Current use case (if it's a feature request)
            - Any additional context
            
            Thank you for your understanding! üôè
          
          # Pull request configuration  
          stale-pr-message: |
            This pull request has been automatically marked as stale because it has not had recent activity.
            It will be closed if no further activity occurs.
            
            If this PR is still relevant, please:
            - Rebase against the latest main branch
            - Address any review comments
            - Comment to indicate you're still working on it
            - Add the `keep-open` label if needed
            
            Thank you for your contribution! üéâ
          
          close-pr-message: |
            This pull request was automatically closed because it has been stale for too long without activity.
            
            If you'd like to continue this work:
            - Create a new pull request with the updated changes
            - Reference this PR in the new one
            - Ensure all conflicts are resolved
            
            Thank you for your contribution! üëè
          
          # Timing configuration
          days-before-stale: 30          # Mark as stale after 30 days
          days-before-close: 7           # Close after 7 more days
          days-before-pr-close: 14       # PRs get more time before closing
          
          # Labels
          stale-issue-label: 'stale'
          stale-pr-label: 'stale'
          exempt-issue-labels: 'keep-open,bug,enhancement,good first issue,help wanted'
          exempt-pr-labels: 'keep-open,work-in-progress,wip'
          
          # Limits
          operations-per-run: 100
          
          # Only issues/PRs
          only-labels: ''
          
          # Ascending order (oldest first)
          ascending: true
          
          # Remove stale label when issue/PR is updated
          remove-stale-when-updated: true
          
          # Debug mode (set to true for testing)
          debug-only: false
